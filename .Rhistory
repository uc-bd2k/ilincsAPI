req <- POST(apiUrl, body = list(signatureId = paste(ilincs_signatureId),genes = geneids, output="png"), encode = "json")
gseaPlotPng <- content(req)$fileName
gseaPlotUrl <- paste("http://www.ilincs.org/tmp/",gseaPlotPng,".png",sep="")
include_graphics(gseaPlotUrl)
ilincs_signatureId
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/",ilincs_signatureId,sep="")
req <- GET(apiUrl)
l <- lapply(content(req), function(x) unlist(x))
ilincs_result <- data.frame(t(sapply(l,c)))
knitr::kable(t(ilincs_result))
term <- "Diclofenac"
ilincs_libId<-"LIB_5"
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findTermWithSynonyms?term=",term,"&library=",ilincs_libId,sep="")
req <- GET(apiUrl)
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
head(ilincs_result_df)
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
```{r}
term <- "Diclofenac"
ilincs_libId<-"LIB_5"
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findTermWithSynonyms?term=",term,"&library=",ilincs_libId,sep="")
req <- GET(apiUrl)
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
head(ilincs_result_df)
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
ilince_result_df
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
ilincs_libraries[,c("libraryID","libraryName")]
apiUrl <- "http://www.ilincs.org/api/SignatureLibraries"
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
ilincs_libraries <- fromJSON(json)
ilincs_libraries[,c("libraryID","libraryName")]
term <- "Diclofenac"
ilincs_libId<-"LIB_5"
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findTermWithSynonyms?term=",term,"&library=",ilincs_libId,sep="")
req <- GET(apiUrl)
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
head(ilincs_result_df)
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
term <- "Diclofenac"
ilincs_libId<-"LIB_5"
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findTermWithSynonyms?term=",term,"&library=",ilincs_libId,sep="")
req <- GET(apiUrl)
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
# head(ilincs_result_df)
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
ilincs_signatureId <- ilincs_result_df[1,"signatureid"]
ilincs_signatureId
req <- POST("http://www.ilincs.org/api/ilincsR/downloadSignature", body = list(sigID = paste(ilincs_signatureId)), encode = "json")
ilincs_sessionId<-unlist(content(req))
ilincs_sessionId
fileUrl=paste("http://www.ilincs.org/tmp/",ilincs_sessionId,".xls",sep="")
signatureData<-read.table(fileUrl,sep="\t",header=T,stringsAsFactors = F)
head(signatureData)
apiUrl <- paste("http://www.ilincs.org/api/ilincsR/volcanoPlot?file=",ilincs_sessionId,".xls",sep="")
req <- GET(apiUrl)
ilincs_volcanoUrl<-paste("http://www.ilincs.org",content(req)$url,sep="")
knitr::include_graphics(ilincs_volcanoUrl)
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findConcordantSignatures?sigID=",ilincs_signatureId,"&lib=",ilincs_libId,sep="")
req <- GET(apiUrl)
prettify(content(req,type="text"))
ilincs_conn_df<-fromJSON(httr::content(req,type="text"))
head(ilincs_conn_df)
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findConcordantSignatures?sigID=",ilincs_signatureId,"&lib=",ilincs_libId,sep="")
req <- GET(apiUrl)
# prettify(content(req,type="text"))
ilincs_conn_df<-fromJSON(httr::content(req,type="text"))
head(ilincs_conn_df)
glist<-paste(signatureData[order(signatureData$Significance_pvalue)[1:100],"Name_GeneSymbol"],collapse = ",")
glist
apiUrl <- "http://www.ilincs.org/api/ilincsR/GeneListEnrichment"
req <- POST(apiUrl, body = list(geneList=glist, libName="LIB_5"), encode = "form")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
head(connectedSignatures)
apiUrl <- "http://www.ilincs.org/api/ilincsR/plotGSEA"
geneids<-signatureData[order(signatureData$Significance_pvalue)[1:100],"ID_geneid"]
req <- POST(apiUrl, body = list(signatureId = ilincs_signatureId,genes = geneids, output="png"), encode = "json")
gseaPlotPng <- content(req)$fileName
gseaPlotUrl <- paste("http://www.ilincs.org/tmp/",gseaPlotPng,".png",sep="")
include_graphics(gseaPlotUrl)
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/",ilincs_signatureId,sep="")
req <- GET(apiUrl)
l <- lapply(content(req), function(x) unlist(x))
ilincs_result <- data.frame(t(sapply(l,c)))
knitr::kable(t(ilincs_result))
write.table(signatureData,file="sigFile.tsv",sep="\t",row.names=F,col.names = T,quote=F)
system(paste("head sigFile.tsv"))
sigFile <- "sigFile.tsv"
sigFile<-"signatureData.xls"
apiUrl <- "http://www.ilincs.org/api/ilincsR/findConcordances"
req <- (POST(apiUrl, body = list(file=sigFile, lib="LIB_6", path="~/git/ilincsAPI/"), encode = "form"))
output <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
# output <- output[,c("signatureid", "perturbagenID", "treatment", "cellline", "time", "similarity", "pValue", "nGenes")]
head(output)
ilince_result_df<-fromJSON(httr::content(req,type="text"))$data
fileUrl=paste("http://www.ilincs.org/tmp/",ilincs_sessionId,".xls",sep="")
signatureData<-read.table(fileUrl,sep="\t",header=T,stringsAsFactors = F)
head(signatureData)
setwd("~/git/ilincsAPI")
sigFile <- "sigFile.tsv"
sigFile<-"signatureData.xls"
wd()
?setwd
getwd()
processFile <- content(POST("http://www.ilincs.org/api/SignatureMeta/upload", body = list(file = upload_file(sigFile))))
file.exist(sigFile)
file.exists(sigFile)
getwd()
sigFile <- "sigFile.tsv"
sigFile <- "./sigFile.tsv"
sigFile <- "sigFile.tsv"
processFile <- content(POST("http://www.ilincs.org/api/SignatureMeta/upload", body = list(file = upload_file(sigFile))))
signatureFile <- processFile$status$fileName[[1]]
signatureFile
apiUrl <- "http://www.ilincs.org/api/ilincsR/findConcordances"
req <- (POST(apiUrl, body = list(file=signatureFile, lib="LIB_5", path="~/git/ilincsAPI/"), encode = "form"))
output <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
head(output)
processFile <- content(POST("http://www.ilincs.org/api/SignatureMeta/upload", body = list(file = upload_file(sigFile))))
signatureFile <- processFile$status$fileName[[1]]
signatureFile
req <- (POST(apiUrl, body = list(file=signatureFile, lib="LIB_5", path="/mnt/raid/tmp/"), encode = "form"))
req <- (POST(apiUrl, body = list(file=signatureFile, lib="LIB_5", path="/mnt/raid/tmp/"), encode = "form"))
output <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
head(output)
signatureFile
broadID <- "LJP008_ASC.C_24H:I08"
apiUrl <- paste('http://www.ilincs.org/api/SignatureMeta/?filter={"where":{"lincsSigID":"',broadID,'"}}',sep="")
req <- GET(apiUrl)
ilincs_result <- httr::content(req)
iLincsSignatureId <- ilincs_result[[1]]$signatureid
iLincsSignatureId
r <- POST("http://www.ilincs.org/api/ilincsR/downloadSignature", body = list(sigID = iLincsSignatureId,display = FALSE), encode = "json")
iLincsSignatureSessionId <- content(r)$data
iLincsSignatureSessionId
apiUrl <- paste("http://www.ilincs.org/api/ilincsR/signatureEnrichment?sigFile=",iLincsSignatureSessionId,".xls&library=LIB_5",sep="")
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
iLincsConnectedCompoundPerturbations <- fromJSON(json)
iLincsConnectedCompoundPerturbations$enrichment
req <- (POST(apiUrl, body = list(file=signatureFile, lib="LIB_5"), encode = "form"))
output <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
head(output)
```{r connected compound perturbations}
apiUrl <- paste("http://www.ilincs.org/api/ilincsR/signatureEnrichment?sigFile=",signatureFile,"&library=LIB_5&metadata=TRUE",sep="")
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
iLincsConnectedCompoundPerturbations <- fromJSON(json)
iLincsConnectedCompoundPerturbations$enrichment
View(iLincsConnectedCompoundPerturbations$enrichment)
iLincsConnectedGeneticPerturbations <- fromJSON(json)$enrichment
View(iLincsConnectedGeneticPerturbations)
iLincsConnectedCompoundPerturbations <- fromJSON(json)$enrichment
head(iLincsConnectedCompoundPerturbations)
apiUrl <- paste("http://www.ilincs.org/api/ilincsR/signatureEnrichment?sigFile=",signatureFile,"&library=LIB_6",sep="")
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
iLincsConnectedGeneticPerturbations <- fromJSON(json)$enrichment
iLincsConnectedGeneticPerturbations
head(iLincsConnectedGeneticPerturbations)
top100signature <- signatureData[order(signatureData$Significance_pvalue)[1:100],c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
top100signatureGeneSymbols <- top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
head(top100signature)
apiUrl<-"http://www.ilincs.org/api/ilincsR/findConcordancesSC"
req <- POST(apiUrl, body = list(mode="fullSig",metadata=TRUE,signatureProfile = list(fullSig = top100signature)),encode = "json")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
connectedSignatures
top100signature <- signatureData[1:100,]
top100signatureGeneSymbols <- top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
top100signatureGeneSymbols
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
signatureProfile
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req
```{r subsetting signature}
top100signature <- signatureData[1:100,]
top100signatureGeneSymbols <- top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
head(top100signatureGeneSymbols)
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
signatureData <- data.table::rbindlist(processFile$status$Sig, use.names = TRUE, fill = TRUE)
signatureData
## Subsetting signature to 100 most significant genes from sample file
```{r subsetting signature}
top100signature <- signatureData[1:100,]
top100signatureGeneSymbols <- top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
head(top100signatureGeneSymbols)
```
## Uploading signature profile using 100 most significant genes
```{r}
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
```
top100signature <- signatureData[1:100,]
top100signatureGeneSymbols <- top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
head(top100signatureGeneSymbols)
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
```{r}
```{r}
# top100signatureGeneSymbols
signatureProfile <- as.list(fullSig = top100signatureGeneSymbols)
# top100signatureGeneSymbols
signatureProfile <- list(fullSig = top100signatureGeneSymbols)
# signatureProfile$fullSig
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="fullSig",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
top100Genes <- as.list(top100signature[,"Name_GeneSymbol"])
names(top100Genes) <- "genes"
signatureProfile <- top100Genes
signatureProfile
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="geneList",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
ilincsEnrichedSignatures <- data.table::rbindlist(req$sigScores, use.names = TRUE, fill = TRUE)
ilincsEnrichedSignatures
connectedSignatures<-fromJSON(httr::content(req,type="text"))
connectedSignatures<-fromJSON(httr::content(req)$sigScores)
connectedSignatures<-fromJSON(httr::content(req,type="text"))
ilincsEnrichedSignatures <- data.table::rbindlist(req$sigScores, use.names = TRUE, fill = TRUE)
top100Genes <- as.list(top100signature[,"Name_GeneSymbol"])
names(top100Genes) <- "genes"
top100Genes
top100Genes <- as.list(genes=top100signature[,"Name_GeneSymbol"])
top100Genes <- list(genes=top100signature[,"Name_GeneSymbol"])
top100Genes
top100Genes <- list(genes=top100signature$Name_GeneSymbol)#top100signature[,"Name_GeneSymbol"])
top100Genes
signatureProfile <- top100Genes
req <- content(POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
req <- content(POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = signatureProfile),encode = "json"))
ilincsEnrichedSignatures <- data.table::rbindlist(req$sigScores, use.names = TRUE, fill = TRUE)
ilincsEnrichedSignatures
```
req <- content(POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = top100Genes),encode = "json"))
req
top100Genes
signatureProfile
top100Genes
signatureProfile
req
req <- (POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = top100Genes),encode = "json"))
req
ilincsEnrichedSignatures <- data.table::rbindlist(content(req)$sigScores, use.names = TRUE, fill = TRUE)
head(ilincsEnrichedSignatures)
rm(ilincsEnrichedSignatures)
head(ilincsEnrichedSignatures)
ilincsEnrichedSignatures <- data.table::rbindlist(content(req)$sigScores, use.names = TRUE, fill = TRUE)
head(ilincsEnrichedSignatures)
req <- POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = list(genes=top100signature$Name_GeneSymbol)),encode = "json")
rm(ilincsEnrichedSignatures)
ilincsEnrichedSignatures <- data.table::rbindlist(content(req)$sigScores, use.names = TRUE, fill = TRUE)
head(ilincsEnrichedSignatures)
length(content(req))
names(content(req))
length(content(req)$sigScores)
head(content(req)$sigScores)
```{r query gene list}
glist<-paste(signatureData[order(signatureData$Significance_pvalue)[1:100],"Name_GeneSymbol"],collapse = ",")
glist
apiUrl <- "http://www.ilincs.org/api/ilincsR/GeneListEnrichment"
req <- POST(apiUrl, body = list(geneList=glist, libName="LIB_5"), encode = "form")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
head(connectedSignatures)
glist<-paste(signatureData[order(signatureData$Significance_pvalue)[1:100],"Name_GeneSymbol"],sep = ",")
glist
glist<-paste(signatureData[order(signatureData$Significance_pvalue)[1:100],"Name_GeneSymbol"],col = ",")
glist
glist<-paste(signatureData[order(signatureData[,"Significance_pvalue"])[1:100],"Name_GeneSymbol"],collapse = ",")
glist
glist<-paste(signatureData$"Name_GeneSymbol"[order(signatureData$Significance_pvalue)[1:100]],collapse = ",")
glist
glist<-paste(signatureData$Name_GeneSymbol[order(signatureData$Significance_pvalue)[1:100]],collapse = ",")
glist
apiUrl <- "http://www.ilincs.org/api/ilincsR/GeneListEnrichment"
req <- POST(apiUrl, body = list(geneList=glist, libName="LIB_5"), encode = "form")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
head(connectedSignatures)
apiUrl <- "http://www.ilincs.org/api/ilincsR/plotGSEA"
req <- POST(apiUrl, body = list(signatureId = ilincs_signatureId,genes = top100signature$ID_geneid, output="png"), encode = "json")
gseaPlotPng <- content(req)$fileName
gseaPlotUrl <- paste("http://www.ilincs.org/tmp/",gseaPlotPng,".png",sep="")
include_graphics(gseaPlotUrl)
topUpRegulatedGenes <- list(genesUp=top100signature$Name_GeneSymbol[Value_LogDiffExp > 0])
topUpRegulatedGenes <- list(genesUp=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp > 0])
topUpRegulatedGenes
topDownregulatedGenes <- list(genesDown=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp < 0])
topUpRegulatedGenes <- list(genesUp=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp > 0])
topDownregulatedGenes <- list(genesDown=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp < 0])
req <- content(POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="UpDn",metadata=TRUE,signatureProfile = c(topUpRegulatedGenes, topDownregulatedGenes)),encode = "json"))
ilincsUpDnConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsUpDnConnectedSignatures
apiUrl="http://www.ilincs.org/api/ilincsR/findConcordancesSC"
topUpRegulatedGenes <- list(genesUp=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp > 0])
topDownregulatedGenes <- list(genesDown=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp < 0])
req <- POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="UpDn",metadata=TRUE,signatureProfile = c(topUpRegulatedGenes, topDownregulatedGenes)),encode = "json")
ilincsUpDnConnectedSignatures <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsUpDnConnectedSignatures
apiUrl<-"http://www.ilincs.org/api/ilincsR/findConcordancesSC"
req <- POST(apiUrl, body = list(mode="fullSig",metadata=TRUE,signatureProfile = list(fullSig = top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")])),encode = "json")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
head(connectedSignatures)
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
apiUrl <- "http://www.ilincs.org/api/SignatureLibraries"
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
ilincs_libraries <- fromJSON(json)
ilincs_libraries[,c("libraryID","libraryName")]
term <- "Diclofenac"
ilincs_libId<-"LIB_5"
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findTermWithSynonyms?term=",term,"&library=",ilincs_libId,sep="")
req <- GET(apiUrl)
ilincs_result_df<-fromJSON(httr::content(req,type="text"))$data
# head(ilincs_result_df)
head(ilincs_result_df[,c("cellline","compound","concentration","signatureid","is_exemplar")])
ilincs_signatureId <- ilincs_result_df[1,"signatureid"]
ilincs_signatureId
req <- POST("http://www.ilincs.org/api/ilincsR/downloadSignature", body = list(sigID = paste(ilincs_signatureId)), encode = "json")
ilincs_sessionId<-unlist(content(req))
ilincs_sessionId
fileUrl=paste("http://www.ilincs.org/tmp/",ilincs_sessionId,".xls",sep="")
signatureData<-read.table(fileUrl,sep="\t",header=T,stringsAsFactors = F)
head(signatureData)
apiUrl <- paste("http://www.ilincs.org/api/ilincsR/volcanoPlot?file=",ilincs_sessionId,".xls",sep="")
req <- GET(apiUrl)
ilincs_volcanoUrl<-paste("http://www.ilincs.org",content(req)$url,sep="")
knitr::include_graphics(ilincs_volcanoUrl)
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/findConcordantSignatures?sigID=",ilincs_signatureId,"&lib=",ilincs_libId,sep="")
req <- GET(apiUrl)
# prettify(content(req,type="text"))
ilincs_conn_df<-fromJSON(httr::content(req,type="text"))
head(ilincs_conn_df)
# top100signature <- signatureData[order(signatureData$Significance_pvalue)[1:100],c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")]
top100signature <- signatureData[order(signatureData$Significance_pvalue)[1:100],]
head(top100signature)
apiUrl="http://www.ilincs.org/api/ilincsR/findConcordancesSC"
req <- POST(apiUrl, body = list(mode="geneList",metadata=TRUE,signatureProfile = list(genes=top100signature$Name_GeneSymbol)),encode = "json")
ilincsEnrichedSignatures <- data.table::rbindlist(content(req)$sigScores, use.names = TRUE, fill = TRUE)
head(ilincsEnrichedSignatures)
apiUrl <- "http://www.ilincs.org/api/ilincsR/plotGSEA"
req <- POST(apiUrl, body = list(signatureId = ilincs_signatureId,genes = top100signature$ID_geneid, output="png"), encode = "json")
gseaPlotPng <- content(req)$fileName
gseaPlotUrl <- paste("http://www.ilincs.org/tmp/",gseaPlotPng,".png",sep="")
include_graphics(gseaPlotUrl)
```{r up and down genes}
apiUrl="http://www.ilincs.org/api/ilincsR/findConcordancesSC"
topUpRegulatedGenes <- list(genesUp=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp > 0])
topDownregulatedGenes <- list(genesDown=top100signature$Name_GeneSymbol[top100signature$Value_LogDiffExp < 0])
req <- POST("http://www.ilincs.org/api/ilincsR/findConcordancesSC", body = list(mode="UpDn",metadata=TRUE,signatureProfile = c(topUpRegulatedGenes, topDownregulatedGenes)),encode = "json")
ilincsUpDnConnectedSignatures <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
head(ilincsUpDnConnectedSignatures)
apiUrl<-"http://www.ilincs.org/api/ilincsR/findConcordancesSC"
req <- POST(apiUrl, body = list(mode="fullSig",metadata=TRUE,signatureProfile = list(fullSig = top100signature[,c("Name_GeneSymbol","Value_LogDiffExp","Significance_pvalue")])),encode = "json")
connectedSignatures<-fromJSON(httr::content(req,type="text"))
head(connectedSignatures)
ilincsConnectedSignatures <- data.table::rbindlist(req$concordanceTable, use.names = TRUE, fill = TRUE)
ilincsConnectedSignatures
write.table(signatureData,file="sigFile.tsv",sep="\t",row.names=F,col.names = T,quote=F)
system(paste("head sigFile.tsv"))
sigFile <- "sigFile.tsv"
processFile <- content(POST("http://www.ilincs.org/api/SignatureMeta/upload", body=list(file=upload_file(sigFile))))
signatureFile <- processFile$status$fileName[[1]]
signatureFile
apiUrl <- "http://www.ilincs.org/api/ilincsR/findConcordances"
req <- (POST(apiUrl, body = list(file=signatureFile, lib="LIB_5", path="/mnt/raid/tmp/"), encode = "form"))
output <- data.table::rbindlist(content(req)$concordanceTable, use.names = TRUE, fill = TRUE)
head(output)
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/",ilincs_signatureId,sep="")
req <- GET(apiUrl)
l <- lapply(content(req), function(x) unlist(x))
ilincs_result <- data.frame(t(sapply(l,c)))
knitr::kable(t(ilincs_result))
l <- lapply(content(req), function(x) unlist(x))
apiUrl <- paste("http://www.ilincs.org/api/SignatureMeta/",ilincs_signatureId,sep="")
req <- GET(apiUrl)
l <- lapply(content(req), function(x) unlist(x))
ilincsSigMetaData<-fromJSON(l)
ilincsSigMetaData<-fromJSON(content(req,type="text"))
head(t(ilincs_result))
?fromJSON
t(ilincs_result)
apiUrl <- "http://www.ilincs.org/api/SignatureLibraries"
req <- GET(apiUrl)
apiUrl <- "http://www.ilincs.org/api/SignatureLibraries"
req <- GET(apiUrl)
json <- httr::content(req, as = "text")
ilincs_libraries <- fromJSON(json)
ilincs_libraries[,c("libraryID","libraryName")]
unlink('usingIlincsApis_cache', recursive = TRUE)
ilincsUpDnConnectedSignatures
signatureGroup <- c(ilincs_signatureId,ilincsUpDnConnectedSignatures[1:20,"signatureID"]
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
signatureGroup <- c(ilincs_signatureId,ilincsUpDnConnectedSignatures[1:20,"signatureID"])
signatureGroup
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
req
ilincs_result
content(req)$data
signatureGroup
signatureGroup <- c(ilincs_signatureId,ilincsUpDnConnectedSignatures$signatureID[1:20]#,"signatureID"])
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
signatureGroup <- c(ilincs_signatureId,ilincsUpDnConnectedSignatures$signatureID[1:20])
signatureGroup
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
groupAnalysisSessionID <- content(req)$data[[2]]
req
content(req)
signatureGroup <- ilincsUpDnConnectedSignatures$signatureID[1:20]
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
heatmap_url<-paste("http://www.ilincs.org/apps/heatmap/?sessionID=",groupAnalysisSessionID,"&property=signatureID&geneCount=100",sep = "")
include_url(heatmap_url, height = "900px")
pca_url<-paste("http://www.ilincs.org/apps/pca/?sessionID=",groupAnalysisSessionID,"&property=signatureID&geneCount=100",sep = "")
include_url(pca_url, height = "900px")
Encoding(pca_url)
Encoding(pca_url)<-"bytes"
include_url(pca_url, height = "900px")
knitr::include_url(u,height="400px")
u<-( "https://apnews.com")
Encoding(u)
Encoding(u)<-"bytes"
knitr::include_url(u,height="400px")
Encoding(pca_url)<-"UTF08"
knitr::include_url(u,height="400px")
include_url(pca_url, height = "900px")
pca_url
signatureGroup <- ilincsUpDnConnectedSignatures$signatureID[1:20]
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
unlink('~/ucGithub/ilincsAPI/Connectivity_cache', recursive = TRUE)
options(width = 1400)
unlink('usingIlincsApis_cache', recursive = TRUE)
signatureGroup <- ilincsUpDnConnectedSignatures$signatureID[1:20]
signatureGroup
signatureGroup <-c("LINCSCP_100","LINCSCP_160","LINCSCP_99")
signatureGroup <-list(sigs=c("LINCSCP_100","LINCSCP_160","LINCSCP_99"))
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
library(knitr)
library(tinytex)
library(httr)
library(jsonlite)
library(plotly)
library(htmltools)
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
groupAnalysisSessionID <- content(req)$data[[2]]
signatureGroup <-(c("LINCSCP_100","LINCSCP_160","LINCSCP_99"))
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
signatureGroup <-c("LINCSCP_100","LINCSCP_160","LINCSCP_99")
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
options(width = 1000)
signatureGroup <-c("LINCSCP_100","LINCSCP_160","LINCSCP_99")
apiUrl<-"http://www.ilincs.org/api/ilincsR/GroupLincsAnalysis"
req<-POST(apiUrl, body = list(idList = signatureGroup,noOfGenes = 50), encode = "json")
ilincs_result <- content(r)$data
groupAnalysisSessionID <- content(req)$data[[2]]
groupAnalysisSessionID
system("rm junk.Rmd")
system("rm *.nb*")
dir()
